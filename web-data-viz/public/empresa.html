<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href='https://cdn.boxicons.com/fonts/basic/boxicons.min.css' rel='stylesheet'>
  <link rel="stylesheet" href="css/empresa.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
  <link rel="icon" href="assets/icon/chip.png">

  <title>Empresas Cadastradas - CyberBeef</title>

</head>

<body>
  <header class="navbar">
    <button id="but_atualizar_bl" class="clicavel bxr bxs-menu-select clicado"
      onclick="atualizarBarraLateral()"></button>

    <span id="sel_componentes" name="op_setor" class="sel_dash">
      <p id="title">Controle de Empresas Cadastradas</p>

      <button id="dash_todas_maquinas" style="display: none;" class="" data-comp="geral"
        data-kpi1="Usuários monitorados" data-kpi2="Tentativas de acesso (7 dias)" data-kpi3="Dias sem incidentes"
        data-kpi4="Usuário com mais ocorrências">GERAL</button>

      <button data-comp="geral" class="" data-kpi1="Setores monitorados" data-kpi2="Tentativas de acesso (7 dias)"
        data-kpi3="Dias sem incidentes" data-kpi4="Setor com mais ocorrências">GERAL</button>

      <button data-comp="cpu" data-kpi1="Último registro de acesso" data-kpi2="Tentativas (7 dias)"
        data-kpi3="Dias sem incidentes" data-kpi4="Variação de acessos (7 dias)">ACESSOS</button>

      <button data-comp="ram" data-kpi1="Último login registrado" data-kpi2="Tentativas suspeitas (7 dias)"
        data-kpi3="Dias sem incidentes" data-kpi4="Variação de login (7 dias)">LOGINS</button>

      <button data-comp="disco" data-kpi1="Última alteração de permissão" data-kpi2="Eventos críticos (7 dias)"
        data-kpi3="Dias sem alterações" data-kpi4="Setor com mais alterações">PERMISSÕES</button>

      <button data-comp="rede" data-kpi1="Dados enviados (última captura)" data-kpi2="Tentativas bloqueadas (7 dias)"
        data-kpi3="Dias sem falhas" data-kpi4="Índice de pacotes rejeitados">REDE</button>
    </span>

    <nav id="buts_superiores">
      <a class="clicavel clicado">Cadastrar  <i class='bx bx-plus' style="padding: 0.3rem;"></i></a>
      <!-- <a class="clicavel clicado">Gerar relatório</a> -->
    </nav>
  </header>

  <div class="barra_lateral sombreado ativa">
    <div id="logo"></div>
    <hr>

    <div id="usuario">
      <i class='bxr bxs-user' style='color:#fffafa'></i>
      <a id="b_usuario" class="texto_perfil" style="max-width: 100%; overflow: hidden; text-overflow: ellipsis;">
        Administrador
      </a>
    </div>

    <hr>

    <div id="home" class="ops_home">
      <ul></ul>
      <li class="clicado"><a href="index.html">Controle e Acesso</a></li>
      <li class="clicado"><a>Cadastro Empresa</a></li>
      <li class="clicado"><a href="dados.html?tipoDados=alerta&titulo=Alertas">Downtime</a></li>
      <li class="clicado"><a href="dados.html?tipoDados=setor&titulo=Setores">Chamados Jira</a></li>

      <span onclick="limparSessao()"
        style="display: inline-flex; align-items: center; color: #fffafa; font-size: large; gap: 1%;"
        class="clicavel clicado" title="Clique para encerrar sua sessão">
        <i class='bxr bx-arrow-out-left-square-half' style="color: #fffafa;"></i>
        <p>ENCERRAR SESSÃO</p>
      </span>
    </div>
  </div>

  <div id="elementos" class="bl_ativa">
    <div class="cards">
      <div id="barra_pesquisa">
        <input type="text" placeholder="" id="pesquisa" class="interativo">
        <div id="nomes_dash" class="accordion"></div>
      </div>

      <span class="abas_kpis">
        <button data-aba="1" class="kpi interativo ativa">
          <b id="kpi1" class="dado_card">57</b>
          <p id="kpi1_desc">Total de Empresas Cadastradas</p>
          <i id="kpi1_result" class="text_longo">Desde implementação da solução</i>
        </button>

        <button data-aba="2" class="kpi interativo">
          <b id="kpi2" class="dado_card">2%</b>
          <p id="kpi2_desc">Taxa de Cancelamento</p>
          
          <i id="kpi2_result" class="text_longo">No Último Semestre</i>
        </button>

        <button data-aba="3" class="kpi interativo">
          <b id="kpi3" class="dado_card">12</b>
          <p id="kpi3_desc">Novas Empresas Cadastradas</p>
          <i id="kpi3_result" class="text_longo">No Último Semestre</i>
        </button>

        <button data-aba="4" class="kpi interativo">
          <b id="kpi4" class="dado_card">22%</b>
          <p id="kpi4_desc" class="text_longo">Crescimento Contratual</p>
          <i id="kpi4_result" class="text_longo">No Último Semestre</i>
        </button>
      </span>


      <div class="graficos-meio">
        <span class="grafico-duplo sombreado interativo">
          <canvas id="grafico3"></canvas>
        </span>
        <span class="grafico-duplo sombreado interativo">
          <canvas id="grafico1"></canvas>
        </span>
      </div>

      <div id="cardsContainer"></div>
    </div>

    <div id="graficos">
      <span class="grafico sombreado interativo">
        <div class="map-title">Distribuição de Empresas Cadastradas no Brasil</div>

        <div id="geoChart"></div>

       <div class="map-legend">
        <span class="legend-title">Empresas cadastradas</span>

        <div class="legend-gradient"></div>

        <div class="legend-labels">
            <span>Menor</span>
            <span>Maior</span>
        </div>

        <p class="legend-desc">Tonalidade mais escura indica maior quantidade</p>
    </div>

        <div class="map-stats">
          <div class="map-stat">
            <h3>51</h3>
            <p>Cidades</p>
          </div>

          <div class="map-stat">
            <h3>28</h3>
            <p>Estados</p>
          </div>
        </div>
      </span>
    </div>
  </div>

  <script>
   const ctx1 = document.getElementById('grafico1').getContext('2d');

// Criar um gradiente moderno
const gradientBar = ctx1.createLinearGradient(0, 0, 0, 300);
gradientBar.addColorStop(0, 'rgba(70, 130, 255, 0.9)');
gradientBar.addColorStop(1, 'rgba(70, 130, 255, 0.3)');

new Chart(ctx1, {
  type: 'bar',
  data: {
    labels: ['São Paulo', 'Rio de Janeiro', 'Belo Horizonte', 'Brasília', 'Salvador', 'Fortaleza'],
    datasets: [{
      label: 'Contratos',
      data: [45, 32, 28, 22, 18, 15],
      backgroundColor: gradientBar,
      borderRadius: 8,
      borderWidth: 0
    }]
  },
  options: {
    responsive: true,
    maintainAspectRatio: false,
    plugins: {
      legend: {
        display: false
      },
      title: {
        display: true,
        text: 'Top 5 Cidades por Número de Contratos',
        color: '#fff',
        font: { size: 16, weight: 'bold' }
      },
      tooltip: {
        backgroundColor: '#1b1f3a',
        titleColor: '#fff',
        bodyColor: '#fff',
        borderColor: '#4B6CF0',
        borderWidth: 1
      }
    },
    scales: {
      x: {
        ticks: { color: '#cfd7ff', font: { size: 11 } },
        grid: { display: false }
      },
      y: {
        ticks: { color: '#cfd7ff', font: { size: 11 } },
        grid: { color: 'rgba(255,255,255,0.07)' }
      }
    }
  }
});


      const ctx3 = document.getElementById('grafico3').getContext('2d');

// Gradiente suave para linha 1
const gradientLine1 = ctx3.createLinearGradient(0, 0, 0, 300);
gradientLine1.addColorStop(0, 'rgba(0, 140, 255, 0.35)');
gradientLine1.addColorStop(1, 'rgba(0, 140, 255, 0)');

// Gradiente suave para linha 2
const gradientLine2 = ctx3.createLinearGradient(0, 0, 0, 300);
gradientLine2.addColorStop(0, 'rgba(255, 0, 80, 0.35)');
gradientLine2.addColorStop(1, 'rgba(255, 0, 80, 0)');

new Chart(ctx3, {
  type: 'line',
  data: {
    labels: ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun'],
    datasets: [
      {
        label: 'Contratos Efetivados',
        data: [20, 35, 30, 50, 45, 60],
        borderColor: '#008cff',
        backgroundColor: gradientLine1,
        borderWidth: 3,
        fill: true,
        tension: 0.45,
        pointRadius: 5,
        pointHoverRadius: 7,
        pointBackgroundColor: '#fff',
        pointBorderColor: '#008cff',
        pointBorderWidth: 2
      },
      {
        label: 'Contratos Quebrados',
        data: [5, 7, 4, 6, 8, 5], // <-- adicione seus valores aqui
        borderColor: '#ff0050',
        backgroundColor: gradientLine2,
        borderWidth: 3,
        fill: true,
        tension: 0.45,
        pointRadius: 5,
        pointHoverRadius: 7,
        pointBackgroundColor: '#fff',
        pointBorderColor: '#ff0050',
        pointBorderWidth: 2
      }
    ]
  },
  options: {
    responsive: true,
    maintainAspectRatio: false,
    plugins: {
      legend: {
        labels: { color: '#fff' }
      },
      title: {
        display: true,
        text: 'Desempenho de Contratação - Último Semestre',
        color: '#fff',
        font: { size: 16, weight: 'bold' }
      },
      tooltip: {
        backgroundColor: '#1b1f3a',
        titleColor: '#fff',
        bodyColor: '#fff',
        borderColor: '#008cff',
        borderWidth: 1
      }
    },
    scales: {
      x: {
        ticks: { color: '#cfd7ff' },
        grid: { color: 'rgba(255,255,255,0.05)' }
      },
      y: {
        ticks: { color: '#cfd7ff' },
        grid: { color: 'rgba(255,255,255,0.07)' }
      }
    }
  }
});


    

    /* google charts */
    google.charts.load('current', {
      packages: ['geochart'],
      mapsApiKey: 'AIzaSyD-9tSrke72PouQMnMX-a7eZSW0jkFMBWY' // descomente se tiver uma chave válida
    });
    google.charts.setOnLoadCallback(drawGeoChart);

    function drawGeoChart() {
      var data = google.visualization.arrayToDataTable([
        ['Estado', 'Clientes'],
        ['BR-SP', 12],
        ['BR-RJ', 8],
        ['BR-MG', 7],
        ['BR-RS', 6],
        ['BR-PR', 5],
        ['BR-BA', 4],
        ['BR-SC', 3],
        ['BR-PE', 3],
        ['BR-CE', 3],
        ['BR-GO', 2],
        ['BR-PA', 2],
        ['BR-ES', 1]
      ]);

 var data = new google.visualization.DataTable();
data.addColumn('string', 'Estado');
data.addColumn('number', 'Clientes');

data.addRows([
  ['BR-SP', 12],
  ['BR-RJ', 8],
  ['BR-MG', 7],
  ['BR-RS', 6],
  ['BR-PR', 5],
  ['BR-BA', 4],
  ['BR-SC', 3],
  ['BR-PE', 3],
  ['BR-CE', 3],
  ['BR-GO', 2],
  ['BR-PA', 2],
  ['BR-ES', 1]
]);




      var options = {
        region: 'BR',
        displayMode: 'regions',
        resolution: 'provinces',
        backgroundColor: 'transparent',
        datalessRegionColor: '#fff',
        defaultColor: '#1a1a2e',
        colorAxis: {
          colors: ['#8AB4FF', '#1A3DBE']
        },
        tooltip: {
          isHtml: false,
          textStyle: {
            color: '#000',
            fontSize: 12
          }
        },
        legend: 'none',
        // Centralizando o mapa
        chartArea: {
          left: 0,
          top: 0,
          width: '100%',
          height: '100%'
        },
        width: '100%',
        height: '100%'
        
      };

      var chart = new google.visualization.GeoChart(document.getElementById('geoChart'));
      chart.draw(data, options);
    }

    window.addEventListener('resize', function () {
      if (typeof drawGeoChart === 'function') {
        drawGeoChart();
      }
    });

    function atualizarBarraLateral() {
      const barraLateral = document.querySelector('.barra_lateral');
      const elementos = document.getElementById('elementos');

      if (barraLateral.classList.contains('ativa')) {
        barraLateral.classList.remove('ativa');
        elementos.classList.remove('bl_ativa');
      } else {
        barraLateral.classList.add('ativa');
        elementos.classList.add('bl_ativa');
      }
    }

    function limparSessao() {
      alert('Sessão encerrada com sucesso!');
    }
  </script>
</body>

</html>